<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.wowoniu.fendian.mapper.ActivitySetMapper">

    <!-- 根据父级用户ID获取会员用户集合 以团队人数倒叙 limit 取数据量 -->
    <select id="getWaresOrder" resultType="com.alibaba.fastjson.JSONObject">
        SELECT * FROM wares_order o
        LEFT JOIN wares w ON w.id = o.wares_id
        LEFT JOIN wares_spec s ON s.id = o.spec_id
        WHERE o.wares_id = #{userId}
        <if test="states != null">
            AND o.state IN
            <foreach item="item" index="index" collection="states" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        ORDER BY o.create_time DESC
    </select>

    <!-- 批量更新裂变详情 -->
    <update id="updateFissionSetDetailList">
        <foreach collection="fissionSetDetailList" item="item" index="index" close="" open="" separator=";">
            UPDATE fission_set_detail SET level_name=#{level_name},equity=#{equity},coupon_type=#{coupon_type},
            discount_money=#{discount_money},use_threshold=#{use_threshold},month_number=#{month_number},use_range=#{use_range},
            exchange_coupon_name=#{exchange_coupon_name},discount=#{discount}
            WHERE id =#{id}
        </foreach>
    </update>

</mapper>